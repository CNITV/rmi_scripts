#!/usr/bin/env python3
#
# Deletes users from CMS
#
# Made by Tudor Roman, public domain
#
# This script expects as its first argument a table generated by add_users.
#

import csv
import sys
from subprocess import call

if len(sys.argv) != 3:
    print("Usage: cleanup_participation <csv_file> <contest_id>")
    sys.exit(1)

with open(sys.argv[1]) as file:
    reader = csv.DictReader(file, delimiter=',')
    for row in reader:
        call(['cmsRemoveParticipation', row['username'], '-c', sys.argv[2]])
